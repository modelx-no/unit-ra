= Få tilgang til data - løsningsmønster UHF
:wysiwig_editing: 1
ifeval::[{wysiwig_editing} == 1]
:imagepath: ../images/
endif::[]
ifeval::[{wysiwig_editing} == 0]
:imagepath: master@drafts:Løsningsmønstre forespørsel UHF:
endif::[]
:toc: left
:toclevels: 3
:sectnums:
:sectnumlevels: 9

== Få tilgang til data - løsningsmønster UHF - oversikt

En arbeidsflyt en konsument av data må gjennomføre for å få tildelt rettigheter til data gjennom et API. Det omfatter å få kjennskap til aktuelt API gjennom API-katalogen, autentisere konsumenten, inngå avtale om bruk av data, samt å registrere tilganger hos den tekniske komponenten som skal utføre tjenestekallet. Dersom det dreier seg om tilgang til et åpent tilgjengelig API, kan enkelte delaktiviteter i prosessene hoppes over, men for å kunne logge informasjon om bruk av APIer bør alle konsumenter av et API registreres i klientregisteret.


.Få tilgang til data - løsningsmønster UHF
image::{imagepath}Få tilgang til data - løsningsmønster UHF.png[alt=Få tilgang til data - løsningsmønster UHF image]

== Data-konsument

Den som innhenter eller mottar data fra andre aktører.

== Beskrivelse API

Dataobjekt som er en maskinlesbar beskrivelse av REST API-er iht. Open API Specification. Dette er formatet som benyttes for å registrere et API i felles API-katalog

Ønsker å bruke Open API spesifikasjon

== API-søk

Tjeneste for å søke etter og finne tilgjengelige API-er

== Få tilgang til data (konsument)

Evnen til å skaffe seg tilgang til tilbudte data fra annen aktør. 

== UHF API katalog

Oversikt over alle API som er registrert 

== UHF tildel rettigheter til klienter



== API tilgangs-forespørsel

API eieren får forespørsel om den vil gi konsumenten tilgang til APIet.

== UHF Oauth2 autorisasjonstjener

Autorisasjonstjeneter realiserer tilgangskontroll gjennom å utstede OpenID Connect eller OAuth 2 grants og tokens. En autorisasjonstjener er også brukt til å realisere tilgangs policy. 

Scope (rettighet) og Audience (identifikator eller ressurs-server f. eks. FS)

Per i dag er Scopes er grovkornet
Rich authorization requsts (ny spesifikasjon) for å utvide scope begrep i IETF
underenhet og behandlingssted, behandlingsgrunnlag og roller jobbes det med.

=== UHF Klientregister

Oversikt over alle klienter som er blitt tildelt tilgang til ressurser.


== OAUTH scopes

Hvordan får Dataobjekt som som kan beskrives som en ressurs-definisjon, og et token er som regel knyttet til ett eller flere scopes. Scopes benyttes til å styre tilganger til API-er og operasjoner, samt eventuelt hva slags responser man får fra API-er.

Fra eHelse: Regler for et API som beskriver hvilke tilganger en datakonsument (representert ved organisasjonsnummer) og deres klienter skal ha tilgang til (utstedt token for).



